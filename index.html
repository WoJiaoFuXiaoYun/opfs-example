<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OPFS 文件管理器</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    /* 自定义滚动条样式 */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    .context-menu {
      display: none;
      position: absolute;
      z-index: 1000;
    }

    .modal-backdrop,
    #drag-overlay {
      transition: opacity 0.3s ease;
    }

    .modal-content {
      transition: transform 0.3s ease;
    }

    /* 选中项的样式 */
    .item-link.selected {
      background-color: #eff6ff;
      /* bg-blue-50 */
      border-color: #3b82f6;
      /* border-blue-500 */
      box-shadow: 0 0 0 2px #3b82f6;
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-800">

  <div id="app" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 min-h-screen flex flex-col relative">
    <!-- 头部 -->
    <header class="flex items-center justify-between pb-4 border-b border-gray-200 mb-4">
      <div>
        <h1 class="text-2xl font-bold text-gray-900">OPFS 文件管理器</h1>
        <p class="text-sm text-gray-500 mt-1">单击选中，双击打开。支持 Ctrl/Shift 多选。</p>
      </div>
      <div id="header-actions" class="flex items-center space-x-2">
        <button id="delete-selected-btn"
          class="hidden bg-red-600 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-red-700 transition-colors duration-200 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
          </svg>
          删除选中
        </button>
        <label for="image-upload"
          class="cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-700 transition-colors duration-200 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
          </svg>
          上传图片
        </label>
        <input id="image-upload" type="file" class="hidden" accept="image/*" multiple>
        <button id="create-folder-btn"
          class="bg-white text-gray-700 px-4 py-2 rounded-lg shadow-sm border border-gray-300 hover:bg-gray-50 transition-colors duration-200 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          新建文件夹
        </button>
      </div>
    </header>

    <!-- 导航/面包屑 -->
    <nav id="breadcrumb"
      class="flex items-center space-x-2 text-sm text-gray-500 mb-4 bg-white p-3 rounded-lg shadow-sm">
      <!-- 面包屑导航将在这里动态生成 -->
    </nav>

    <!-- 文件列表 -->
    <main id="file-list"
      class="flex-grow grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4 content-start">
      <!-- 文件和文件夹将在这里动态生成 -->
    </main>

    <!-- 加载提示 -->
    <div id="loading" class="hidden text-center py-10">
      <p class="text-gray-500">正在加载文件...</p>
    </div>

    <!-- 拖拽上传浮层 -->
    <div id="drag-overlay"
      class="hidden fixed inset-0 bg-blue-500 bg-opacity-75 flex items-center justify-center z-40 pointer-events-none">
      <div class="text-center text-white">
        <svg class="mx-auto h-24 w-24" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
        </svg>
        <p class="mt-4 text-2xl font-bold">拖拽文件到此处以上传</p>
      </div>
    </div>

    <!-- 兼容性提示 -->
    <div id="compatibility-notice"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white p-8 rounded-lg shadow-xl text-center">
        <h2 class="text-xl font-bold mb-4">浏览器不兼容</h2>
        <p>抱歉，您的浏览器不支持 Origin Private File System API。</p>
        <p>请尝试使用最新版本的 Chrome, Edge, 或 Opera 浏览器。</p>
      </div>
    </div>

    <!-- 图片预览模态框 -->
    <div id="image-preview-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
      <div class="max-w-4xl max-h-full bg-white rounded-lg shadow-2xl overflow-hidden relative">
        <img id="preview-image" src="" alt="图片预览" class="max-w-full max-h-[90vh] object-contain">
        <button id="close-modal-btn"
          class="absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-75 transition">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>

    <!-- 通用对话框/模态框 -->
    <div id="dialog-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 modal-backdrop">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-sm modal-content">
        <div class="p-6">
          <h3 id="dialog-title" class="text-lg font-medium text-gray-900">对话框标题</h3>
          <p id="dialog-message" class="mt-2 text-sm text-gray-600">对话框消息。</p>
          <div id="dialog-input-container" class="mt-4 hidden">
            <input type="text" id="dialog-input"
              class="w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
          </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse rounded-b-lg">
          <button id="dialog-confirm-btn" type="button"
            class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm">确认</button>
          <button id="dialog-cancel-btn" type="button"
            class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">取消</button>
        </div>
      </div>
    </div>

    <!-- 右键菜单 -->
    <div id="context-menu" class="context-menu bg-white border border-gray-200 rounded-md shadow-lg py-1 w-36">
      <a href="#" id="context-delete" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50">删除</a>
    </div>

  </div>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      // --- 检查浏览器兼容性 ---
      if (!navigator.storage || !navigator.storage.getDirectory) {
        document.getElementById('compatibility-notice').classList.remove('hidden');
        return;
      }

      // --- 全局变量和状态 ---
      const appEl = document.getElementById('app');
      const fileListEl = document.getElementById('file-list');
      const breadcrumbEl = document.getElementById('breadcrumb');
      const loadingEl = document.getElementById('loading');
      const imageUploadInput = document.getElementById('image-upload');
      const createFolderBtn = document.getElementById('create-folder-btn');
      const deleteSelectedBtn = document.getElementById('delete-selected-btn');
      const imagePreviewModal = document.getElementById('image-preview-modal');
      const previewImageEl = document.getElementById('preview-image');
      const closeModalBtn = document.getElementById('close-modal-btn');
      const contextMenu = document.getElementById('context-menu');
      const contextDeleteBtn = document.getElementById('context-delete');
      const dragOverlay = document.getElementById('drag-overlay');

      // --- 对话框元素 ---
      const dialogModal = document.getElementById('dialog-modal');
      const dialogTitle = document.getElementById('dialog-title');
      const dialogMessage = document.getElementById('dialog-message');
      const dialogInputContainer = document.getElementById('dialog-input-container');
      const dialogInput = document.getElementById('dialog-input');
      const dialogConfirmBtn = document.getElementById('dialog-confirm-btn');
      const dialogCancelBtn = document.getElementById('dialog-cancel-btn');

      let rootHandle;
      let currentDirectoryHandle;
      let currentEntries = []; // 存储当前目录的条目
      let pathStack = [];
      let contextTarget = null;
      let dialogResolve = null;

      // --- 选择相关状态 ---
      let selectedItems = new Set();
      let lastSelectedItemName = null;

      // --- 初始化 ---
      try {
        rootHandle = await navigator.storage.getDirectory();
        currentDirectoryHandle = rootHandle;
        pathStack.push({ name: 'root', handle: rootHandle });
        await renderFileList();
      } catch (error) {
        console.error('获取 OPFS 根目录失败:', error);
        await showDialog({ type: 'alert', title: '错误', message: '无法访问文件系统，请检查浏览器权限设置。' });
      }

      // --- 通用对话框函数 ---
      function showDialog(options) {
        return new Promise(resolve => {
          dialogResolve = resolve;
          dialogTitle.textContent = options.title;
          dialogMessage.textContent = options.message;
          dialogConfirmBtn.textContent = options.confirmText || '确认';
          dialogCancelBtn.textContent = options.cancelText || '取消';
          if (options.type === 'prompt') {
            dialogInputContainer.classList.remove('hidden');
            dialogInput.value = options.defaultValue || '';
            dialogInput.focus();
            dialogCancelBtn.classList.remove('hidden');
          } else if (options.type === 'confirm') {
            dialogInputContainer.classList.add('hidden');
            dialogCancelBtn.classList.remove('hidden');
          } else { // alert
            dialogInputContainer.classList.add('hidden');
            dialogCancelBtn.classList.add('hidden');
          }
          dialogModal.classList.remove('hidden');
        });
      }

      // --- 核心功能函数 ---

      /**
       * 渲染当前目录下的文件和文件夹列表
       */
      async function renderFileList() {
        const oldPreviews = fileListEl.querySelectorAll('img[data-object-url]');
        oldPreviews.forEach(img => URL.revokeObjectURL(img.dataset.objectUrl));
        fileListEl.innerHTML = '';
        loadingEl.classList.remove('hidden');
        selectedItems.clear();
        updateSelectionUI();

        try {
          const entries = [];
          for await (const entry of currentDirectoryHandle.values()) {
            entries.push(entry);
          }
          entries.sort((a, b) => {
            if (a.kind === b.kind) return a.name.localeCompare(b.name);
            return a.kind === 'directory' ? -1 : 1;
          });
          currentEntries = entries; // 缓存当前目录条目

          if (entries.length === 0) {
            fileListEl.innerHTML = `<p class="col-span-full text-center text-gray-500 mt-8">这个文件夹是空的</p>`;
          } else {
            entries.forEach(entry => {
              const itemEl = createItemElement(entry);
              fileListEl.appendChild(itemEl);
            });
          }
          renderBreadcrumb();
        } catch (error) {
          console.error('渲染文件列表时出错:', error);
          fileListEl.innerHTML = `<p class="col-span-full text-center text-red-500 mt-8">无法读取文件列表</p>`;
        } finally {
          loadingEl.classList.add('hidden');
        }
      }

      async function loadAndSetImagePreview(fileHandle, iconContainer) {
        try {
          const file = await fileHandle.getFile();
          const url = URL.createObjectURL(file);
          const img = document.createElement('img');
          img.src = url;
          img.dataset.objectUrl = url;
          img.className = 'w-full h-full object-cover rounded-md';
          img.alt = fileHandle.name;
          iconContainer.innerHTML = '';
          iconContainer.appendChild(img);
        } catch (e) {
          console.error('加载图片预览失败:', fileHandle.name, e);
        }
      }

      function createItemElement(entry) {
        const itemWrapper = document.createElement('div');
        itemWrapper.className = 'relative group self-start';

        const itemLink = document.createElement('a');
        itemLink.href = '#';
        itemLink.className = 'item-link flex flex-col items-center justify-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-200 h-36 text-center border-2 border-transparent';
        itemLink.dataset.name = entry.name;
        itemLink.dataset.kind = entry.kind;

        const iconContainer = document.createElement('div');
        iconContainer.className = 'h-16 w-16 flex items-center justify-center pointer-events-none';

        if (entry.kind === 'directory') {
          iconContainer.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" /></svg>`;
        } else {
          iconContainer.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>`;
          if (/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(entry.name)) {
            loadAndSetImagePreview(entry, iconContainer);
          }
        }

        const name = document.createElement('p');
        name.textContent = entry.name;
        name.className = 'text-xs font-medium text-gray-700 mt-2 break-all pointer-events-none';

        itemLink.appendChild(iconContainer);
        itemLink.appendChild(name);
        itemWrapper.appendChild(itemLink);

        // --- 事件监听器绑定 ---
        itemLink.addEventListener('click', (e) => handleItemClick(e, entry));
        itemLink.addEventListener('dblclick', (e) => handleItemDblClick(e, entry));
        itemWrapper.addEventListener('contextmenu', (e) => handleItemContextMenu(e, entry));

        return itemWrapper;
      }

      function renderBreadcrumb() {
        breadcrumbEl.innerHTML = '';
        pathStack.forEach((part, index) => {
          const partEl = document.createElement('a');
          partEl.href = '#';
          partEl.textContent = part.name;
          partEl.className = 'hover:underline';
          if (index === pathStack.length - 1) {
            partEl.className += ' text-blue-600 font-semibold';
            partEl.onclick = (e) => e.preventDefault();
          } else {
            partEl.onclick = (e) => {
              e.preventDefault();
              pathStack = pathStack.slice(0, index + 1);
              currentDirectoryHandle = part.handle;
              renderFileList();
            };
          }
          breadcrumbEl.appendChild(partEl);
          if (index < pathStack.length - 1) {
            const separator = document.createElement('span');
            separator.textContent = '/';
            separator.className = 'mx-2';
            breadcrumbEl.appendChild(separator);
          }
        });
      }

      async function handleFileUpload(files) {
        if (!files || files.length === 0) return;
        const nonImageFiles = [];
        let uploadedCount = 0;
        for (const file of files) {
          if (!file.type.startsWith('image/')) {
            nonImageFiles.push(file.name);
            continue;
          }
          try {
            const fileHandle = await currentDirectoryHandle.getFileHandle(file.name, { create: true });
            const writable = await fileHandle.createWritable();
            await writable.write(file);
            await writable.close();
            uploadedCount++;
          } catch (error) {
            console.error(`上传文件 "${file.name}" 失败:`, error);
            await showDialog({ type: 'alert', title: '上传失败', message: `上传文件 "${file.name}" 失败. 可能文件名已存在或权限不足。` });
          }
        }
        if (uploadedCount > 0) await renderFileList();
        if (nonImageFiles.length > 0) {
          const fileNames = nonImageFiles.join(', ');
          await showDialog({ type: 'alert', title: '不支持的文件类型', message: `以下文件未上传，因为仅支持图片类型: ${fileNames}` });
        }
      }

      async function createNewFolder() {
        const folderName = await showDialog({ type: 'prompt', title: '新建文件夹', message: '请输入新文件夹的名称:', defaultValue: '新文件夹' });
        if (folderName) {
          try {
            await currentDirectoryHandle.getDirectoryHandle(folderName, { create: true });
            await renderFileList();
          } catch (error) {
            console.error('创建文件夹失败:', error);
            await showDialog({ type: 'alert', title: '创建失败', message: `创建文件夹 "${folderName}" 失败. 可能名称已存在或无效。` });
          }
        }
      }

      async function deleteSelectedItems() {
        if (selectedItems.size === 0) return;
        const confirmed = await showDialog({
          type: 'confirm',
          title: '确认删除',
          message: `您确定要删除选中的 ${selectedItems.size} 个项目吗？此操作不可撤销。`,
          confirmText: '删除',
        });
        if (confirmed) {
          // 创建一个要删除项的副本，以防在迭代时 selectedItems 被修改
          const itemsToDelete = new Set(selectedItems);
          for (const itemName of itemsToDelete) {
            const entry = currentEntries.find(e => e.name === itemName);
            if (entry) {
              try {
                await currentDirectoryHandle.removeEntry(itemName, { recursive: entry.kind === 'directory' });
              } catch (error) {
                console.error(`删除 "${itemName}" 失败:`, error);
                await showDialog({ type: 'alert', title: '删除失败', message: `删除项目 "${itemName}" 失败。` });
                break; // Stop on first error
              }
            }
          }
          await renderFileList();
        }
      }

      async function previewImage(fileName) {
        try {
          const fileHandle = await currentDirectoryHandle.getFileHandle(fileName);
          const file = await fileHandle.getFile();
          const url = URL.createObjectURL(file);
          previewImageEl.src = url;
          previewImageEl.onload = () => {
            if (previewImageEl.dataset.objectUrl) URL.revokeObjectURL(previewImageEl.dataset.objectUrl);
            previewImageEl.dataset.objectUrl = url;
          };
          imagePreviewModal.classList.remove('hidden');
        } catch (error) {
          console.error('预览图片失败:', error);
          await showDialog({ type: 'alert', title: '预览失败', message: '无法加载图片。' });
        }
      }

      // --- 选择逻辑 ---
      function handleItemClick(e, entry) {
        e.preventDefault();
        const { name } = entry
        const isCtrlOrMeta = e.ctrlKey || e.metaKey;
        const isShift = e.shiftKey;

        if (isShift && lastSelectedItemName) {
          const itemNames = currentEntries.map(e => e.name);
          const lastIndex = itemNames.indexOf(lastSelectedItemName);
          const currentIndex = itemNames.indexOf(name);
          const [start, end] = [lastIndex, currentIndex].sort((a, b) => a - b);
          if (!isCtrlOrMeta) selectedItems.clear();
          for (let i = start; i <= end; i++) {
            selectedItems.add(itemNames[i]);
          }
        } else if (isCtrlOrMeta) {
          if (selectedItems.has(name)) {
            selectedItems.delete(name);
          } else {
            selectedItems.add(name);
          }
          lastSelectedItemName = name;
        } else {
          selectedItems.clear();
          selectedItems.add(name);
          lastSelectedItemName = name;
        }
        updateSelectionUI();
      }

      async function handleItemDblClick(e, entry) {
        e.preventDefault();
        if (entry.kind === 'directory') {
          currentDirectoryHandle = await currentDirectoryHandle.getDirectoryHandle(entry.name);
          pathStack.push({ name: entry.name, handle: currentDirectoryHandle });
          await renderFileList();
        } else {
          if (/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(entry.name)) {
            await previewImage(entry.name);
          }
        }
      }

      function handleItemContextMenu(e, entry) {
        e.preventDefault();
        e.stopPropagation();
        if (!selectedItems.has(entry.name)) {
          selectedItems.clear();
          selectedItems.add(entry.name);
          lastSelectedItemName = entry.name;
          updateSelectionUI();
        }
        contextMenu.style.top = `${e.clientY}px`;
        contextMenu.style.left = `${e.clientX}px`;
        contextMenu.style.display = 'block';
      }

      function updateSelectionUI() {
        document.querySelectorAll('.item-link').forEach(el => {
          if (selectedItems.has(el.dataset.name)) {
            el.classList.add('selected');
          } else {
            el.classList.remove('selected');
          }
        });
        if (selectedItems.size > 0) {
          deleteSelectedBtn.classList.remove('hidden');
        } else {
          deleteSelectedBtn.classList.add('hidden');
        }
      }

      // --- 事件监听器 ---
      deleteSelectedBtn.addEventListener('click', deleteSelectedItems);
      imageUploadInput.addEventListener('change', (e) => { handleFileUpload(e.target.files); e.target.value = ''; });
      createFolderBtn.addEventListener('click', createNewFolder);
      closeModalBtn.addEventListener('click', () => {
        imagePreviewModal.classList.add('hidden');
        previewImageEl.src = '';
        if (previewImageEl.dataset.objectUrl) {
          URL.revokeObjectURL(previewImageEl.dataset.objectUrl);
          delete previewImageEl.dataset.objectUrl;
        }
      });
      document.addEventListener('click', (e) => {
        // 如果点击发生在项目、上下文菜单、头部操作按钮或对话框之外，则清除选择。
        if (!e.target.closest('.item-link, .context-menu, #header-actions, #dialog-modal')) {
          selectedItems.clear();
          updateSelectionUI();
        }
        // 如果点击发生在上下文菜单之外，则隐藏它。
        if (!e.target.closest('.context-menu')) {
          contextMenu.style.display = 'none';
        }
      });
      contextDeleteBtn.addEventListener('click', (e) => { e.preventDefault(); deleteSelectedItems(); });
      dialogConfirmBtn.addEventListener('click', () => {
        if (dialogResolve) {
          const isPrompt = !dialogInputContainer.classList.contains('hidden');
          dialogResolve(isPrompt ? dialogInput.value : true);
        }
        dialogModal.classList.add('hidden');
        dialogResolve = null;
      });
      dialogCancelBtn.addEventListener('click', () => {
        if (dialogResolve) {
          const isPrompt = !dialogInputContainer.classList.contains('hidden');
          dialogResolve(isPrompt ? null : false);
        }
        dialogModal.classList.add('hidden');
        dialogResolve = null;
      });
      appEl.addEventListener('dragover', (e) => { e.preventDefault(); dragOverlay.classList.remove('hidden'); });
      appEl.addEventListener('dragleave', (e) => { if (e.relatedTarget === null || !appEl.contains(e.relatedTarget)) { e.preventDefault(); dragOverlay.classList.add('hidden'); } });
      appEl.addEventListener('drop', (e) => { e.preventDefault(); dragOverlay.classList.add('hidden'); handleFileUpload(e.dataTransfer.files); });
    });
  </script>
</body>

</html>
